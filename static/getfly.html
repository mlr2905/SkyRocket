<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>data Records</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>

<body>
    <h1>data</h1>
    <label for="filter">Filter by ID:</label>
    <input type="number" id="filter" placeholder="Enter ID">

    <table border="1" id="table">
        <thead>
        <tr>
            <tr id="trbody"></tr>

        <td id="dataTableBody"></td>
    </thead>
 
    </table>
    <script>
        let filter_id = undefined
        let id_name_chat = 0

        $(document).ready(() => {
            const fetchAndDisplay = (filterid) => {
                let myTable = document.querySelector("#trbody");
                myTable.innerHTML =''
let newTr = document.createElement("tbody");



                const users = ['id', 'username', 'password', 'email'];
                const customers = ['id', 'first_name', 'last_name', 'address', 'phone_no', 'credit_card_no', 'user_id']
                const airlines = ['id', 'name', 'continent_id', 'user_id']
                const countries = ['id', 'name', 'continent_id']
                const flights = ['id', 'airline_id', 'origin_country_id', 'destination_country_id', 'departuer_time', 'landing_time', 'remaining_tickets']
                const tickets = ['id', 'flight_id', 'customer_id']
                if (filter_id === '0') users.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
                if (filter_id === '1') countries.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
                 if (filter_id === '5') tickets.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
               if (filter_id === '2') airlines.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
                if (filter_id === '3') customers.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
                if (filter_id === '4') flights.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
                myTable.appendChild(newTr);

              

                if (filterid !== undefined && filterid !== '') {
                    filter_id = `${filterid}`;
                }
                let url = "/api/all"

                $.ajax({
                    url: url,
                    success: data => displayRecords(data),
                    error: error => console.error('Error fetching records:', error)
                });
            };

            const displayRecords = records => {
                tableBody.empty();
                if (filter_id === '0') {
                    records[0].forEach(appendRow0);
                }
                if (filter_id === '1') {
                    records[1].forEach(appendRow1);
                }
                if (filter_id === '2') {
                    records[2].forEach(appendRow2);
                }
                if (filter_id === '3') {
                    records[3].forEach(appendRow3);
                }
                if (filter_id === '4') {
                    records[4].forEach(appendRow4);
                }
                if (filter_id === '5') {
                    records[5].forEach(appendRow5);
                }

            };
            const name = {
                0: 'users', 1: 'countries', 2: 'airlines', 3: 'customers', 4: 'flights', 5: 'tickets'
            }
            const tableBody = $('#dataTableBody');

            const appendRow0 = record => tableBody.append(`
                <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${record.id}</td>
                    <td>${record.username}</td>
                    <td>${record.password}</td>
                    <td>${record.email}</td>
                    </tr>`);
            const appendRow1 = record => tableBody.append(`
            <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${record.id}</td>
                    <td>${record.name}</td>
                    <td>${record.continent_id}</td>
                    </tr>`);
                    const appendRow2 = record => tableBody.append(`
                <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${record.id}</td>
                    <td>${record.name}</td>
                    <td>${record.country_id}</td>
                    <td>${record.user_id}</td>
                    </tr>`);

            const appendRow3 = record => tableBody.append(`
               
                    <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${record.id}</td>
                    <td>${record.first_name}</td>
                    <td>${record.last_name}</td>
                    <td>${record.address}</td>
                    <td>${record.phone_no}</td>
                    <td>${record.credit_card_no}</td>
                    <td>${record.user_id}</td>
                    </tr>`);
           
            const appendRow4 = record => tableBody.append(`
                <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${record.id}</td>
                    <td>${record.airline_id}</td>
                    <td>${record.origin_country_id}</td>
                    <td>${record.destination_country_id}</td>
                    <td>${record.departuer_time}</td>
                    <td>${record.landing_time}</td>
                    <td>${record.remaining_tickets}</td>
                    </tr>`);

            const appendRow5 = record => tableBody.append(`
                <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${record.id}</td>
                    <td>${record.flight_id}</td>
                    <td>${record.customer_id}</td>
                    </tr>`);


            fetchAndDisplay();
            $('#filter').on('input', function () {
                filter_id = $(this).val();
                fetchAndDisplay(filter_id);
            });
        });
    </script>
</body>

</html>