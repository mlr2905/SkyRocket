<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>data Records</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<style>
    body {

    width: 80%;
    padding: 2%;
}
</style>
<body>
    <h1>data</h1>
    <label for="filter">Filter by ID:</label>
    <input type="number" id="filter" placeholder="Enter ID">

    <table border="1" class="table" id="table">
        <thead id="trbody">

        </thead>
        <tbody id="dataTableBody">
        </tbody>
    </table>
    <script>
        let filter_id = undefined
        let id_name_chat = 0
        const tableBody = $('#dataTableBody');

        const fetchAndDisplay = (filterid) => {
            let myTable = document.querySelector("#trbody");
            let mytable2 = document.querySelector("#dataTableBody");
            myTable.innerHTML = ''
            mytable2.innerHTML = ''

            let newTr = document.createElement("tr");
            const users = ['table number', 'table name', 'id', 'username', 'password', 'email'];
            const countries = ['table number', 'table name', 'id', 'name', 'country_id', 'continent (join)']
            const airlines = ['table number', 'table name', 'id', 'name', 'continent_id', 'user_id', 'user_name (join)']
            const customers = ['table number', 'table name', 'id', 'first_name', 'last_name', 'address', 'phone_no', 'credit_card_no', 'user_id', 'user_name (join)']
            const flights = ['table number', 'table name', 'id', 'airline_id', 'origin_country_id', 'destination_country_id', 'departuer_time', 'landing_time', 'remaining_tickets', 'airline_name (join)', 'origin_country_name (join)', 'destination_country_name (join)']
            const tickets = ['table number', 'table name', 'id', 'flight_id', 'customer_id','flight_destination (join)','passanger_first_name (join)','passanger_last_name (join)','user_name (join)']
            const passangers = ['table number', 'table name','id','first_name','last_name×ª','date_of_birth','passport_number']
            if (filter_id === '0') users.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
            if (filter_id === '1') countries.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
            if (filter_id === '2') airlines.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
            if (filter_id === '3') customers.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
            if (filter_id === '4') flights.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
            if (filter_id === '5') tickets.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);
            if (filter_id === '6') passangers.forEach(header => newTr.appendChild(document.createElement('th')).textContent = header);

            myTable.appendChild(newTr);

            if (filterid !== undefined && filterid !== '') {
                filter_id = `${filterid}`;
            }
            let url = "/api/all"
            $.ajax({
                url: url,
                success: data => displayRecords(data),
                error: error => console.error('Error fetching records:', error)
            });
        };

        const displayRecords = records => {
            const appendFunctions = [appendRow0, appendRow1, appendRow2, appendRow3, appendRow4, appendRow5,appendRow6];
            records[parseInt(filter_id)].forEach(appendFunctions[parseInt(filter_id)]);
        };
        const name = { 0: 'users', 1: 'countries', 2: 'airlines', 3: 'customers', 4: 'flights', 5: 'tickets',6:'passangers' }
        const appendRow0 = records => tableBody.append(`
                <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${records.id}</td>
                    <td>${records.username}</td>
                    <td>${records.password}</td>
                    <td>${records.email}</td>
                    </tr>`);
        const appendRow1 = records => tableBody.append(`
            <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${records.id}</td>
                    <td>${records.country_name}</td>
                    <td>${records.continent_id}</td>
                    <td>${records.continent}</td>

                    </tr>`);
        const appendRow2 = records => tableBody.append(`
                <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${records.id}</td>
                    <td>${records.name}</td>
                    <td>${records.country_id}</td>
                    <td>${records.user_id}</td>
                    <td>${records.user_name}</td>
                    </tr>`);

        const appendRow3 = records => tableBody.append(`
                    <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${records.id}</td>
                    <td>${records.first_name}</td>
                    <td>${records.last_name}</td>
                    <td>${records.address}</td>
                    <td>${records.phone_no}</td>
                    <td>${records.credit_card_no}</td>
                    <td>${records.user_id}</td>
                    <td>${records.user_name}</td>

                    </tr>`);

        const appendRow4 = records => tableBody.append(`
                <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${records.id}</td>
                    <td>${records.airline_id}</td>
                    <td>${records.origin_country_id}</td>
                    <td>${records.destination_country_id}</td>
                    <td>${records.departuer_time}</td>
                    <td>${records.landing_time}</td>
                    <td>${records.remaining_tickets}</td>
                    <td>${records.airline_name}</td>
                    <td>${records.origin_country_name}</td>
                    <td>${records.destination_country_name}</td>


                    </tr>`);

        const appendRow5 = records => tableBody.append(`
                <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${records.id}</td>
                    <td>${records.flight_id}</td>
                    <td>${records.customer_id}</td>
                    <td>${records.flight_destination}</td>
                    <td>${records.first_name}</td>
                    <td>${records.last_name}</td>
                    <td>${records.user_name}</td>
                    </tr>`);
                    const appendRow6 = records => tableBody.append(`
                <tr>
                    <td>${filter_id}</td>
                    <td>${name[filter_id]}</td>
                    <td>${records.id}</td>
                    <td>${records.first_name}</td>
                    <td>${records.last_name}</td>
                    <td>${records.date_of_birth}</td>
                    <td>${records.passport_number}</td>

            
                    </tr>`);


                
        $('#filter').on('input', function () {
            filter_id = $(this).val();
            fetchAndDisplay(filter_id);
        });

    </script>
</body>

</html>